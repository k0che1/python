'''
Пришло время объединить все наши наработки.

Напишите функцию kaprekar_loop(n), которая принимает целое число, и запускающую "Процесс Капрекара" (если это возможно), выводящее на печать каждое число цикла с новой строки до тех пор, пока не будет получено число Капрекара.

Конечных постоянных Капрекара (таких, которые в результате процесса переходят сами в себя) известно 4: 495, 6174, 549945, 631764.
Для некоторых 6-значных чисел возможно не будет найдена постоянная Капрекара, но процесс "зациклится", т.е. одни и те же числа будут получаться по кругу. В этом случае необходимо прервать процедуру на первом повторном числе.

Таким образом возможны 3 случая:
Число не удовлетворяет условиям процесса Капрекара - выводим сообщение "Ошибка! На вход подано число {}, не удовлетворяющее условиям процесса Капрекара"
Процесс Капрекара сойдётся к постоянной Капрекара (495, 6174, 549945 или 631764) - выводим на печать все числа, начиная с исходного и до постоянной Капрекара, каждое с новой строки
Процесс Капрекара зациклится - выводим все числа до момента зацикливания, после чего выводим сообщение "Следующее число - {}, кажется процесс зациклился..."

'''
def numerics(n): #3412 ->[2, 1, 4, 3]
    return [int(i) for i in str(n)]

def kaprekar_check(n): #удовлетвроение условиям
    if (len(numerics(n))==3 or len(numerics(n))==4 or len(numerics(n))==6) and len(set(numerics(n)))!=1 and n!=100 and n!=1000 and n!=100000:
        return True
    else:
        return False
    
def kaprekar_step(L): №формируется 2 числа, находится их разность
    L1=int("".join(map(str, (sorted(L, reverse=True)))))
    L2=int("".join(map(str, (sorted(L)))))
    return L1-L2  

def kaprekar_loop(n):
    if kaprekar_check(n):
        c=set()
        print(n)
        while n not in (495, 6174, 549945, 631764):
            c.add(n)
            n=kaprekar_step(numerics(n))
            if n in c:
                print(f'Следующее число - {n}, кажется процесс зациклился...')
                return
            print(n)
    else:
        print(f'Ошибка! На вход подано число {n}, не удовлетворяющее условиям процесса Капрекара')
        return

kaprekar_loop(300)




